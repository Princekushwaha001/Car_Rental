{% extends 'base.html' %}

{% block content %}
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>

<button id="pay-btn">Pay Now</button>

<script>
var options = {
  "key": "{{ razorpay_key }}",
  "amount": "{{ amount }}00",
  "currency": "INR",
  "order_id": "{{ order_id }}",
  "handler": function (response) {

    fetch("http://127.0.0.1:8000/payments/verify-payment/{{booking_id}}/", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(response)
    })
    .then(res => res.json())
    .then(data => {
      if (data.status === "success") {
        window.location.href = "http://127.0.0.1:8000/payments/payment-success/";
      } else {
         window.location.href = "http://127.0.0.1:8000/payments/payment-failed/";
      }
    });
  }
};

var rzp1 = new Razorpay(options);
document.getElementById("pay-btn").onclick = function (e) {
  rzp1.open();
  e.preventDefault();
};
</script>


{% endblock %}